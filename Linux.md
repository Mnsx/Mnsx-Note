# Linux介绍

linux在服务器领域的应用是最强的

linux免费、稳定、高效等特点在这里得到了很好的表现，尤其在一些高端领域尤为广泛

linux运行稳定、对网络的良好支持性、低成本，且可以根据需要进行软件裁剪，内核最小可以达到几百KB

# 安装VM和Linux

跳过

# 网络连接的三种模式

1. 桥接模式：虚拟系统可以和外部系统通讯，但是容易造成IP冲突
2. NAT模式：网络地址转换模式，虚拟系统可以和外部系统通讯，不造成IP冲突
3. 主机模式：独立的系统

# 克隆虚拟机

* 直接拷贝一份安装好的虚拟机文件
* 使用VMWare克隆操作，注意，克隆时，需要先关闭linux系统

# 虚拟机快照

如果使用虚拟机系统的时候，想要回到原先的某一个状态，VMWare提供了快照管理的功能

# 虚拟机移除和删除

虚拟系统安装好了之后，他的本子就是文件。因此虚拟系统的迁移很方便，可以将安装好的虚拟系统文件夹整体拷贝到另外的位置使用。删除可以使用，VMWare进行移除，再点击菜单——》从磁盘删除即可，或者直接手动删除虚拟系统对应的文件夹即可

# 安装VMTools

1. VMTools安装后，可以让我们在windows下更好的管理vm虚拟机
2. 可以设置windows和CentOS的共享文件夹

安装步骤跳过...

# Linux目录结构

1. Linux的文件系统时采用级层式的树状目录结构，在此结构中的最上层是根目录“/”，然后在此目录下再创建其他的目录
2. 在Linux世界里，一切皆文件

3. 具体目录结构

    * /bin【常用】（/usr/bin、/usr/local/bin）

      是Binary的缩写，这个目录存放最经常使用的命令

    * /sbin（/usr/sbin、/usr/local/sbin）

      s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序

    * /home【常用】

      存放普通用户的主目录，在Linux中每个用户都有一个自己的目录，一般该目录名是以用户的账号命名

    * /root【常用】

      该目录为系统管理员，也称作超级权限这的用户主目录

    * /lib

      系统开机所需要的最基础的动态链接共享库，起作用类似于windows里的DLL文件，几乎所有的应用程序都需要使用这些共享库

    * /lost+found

      这个目录一般情况是空的，当系统非法关机后，这里就存放了一些文件

    * /etc 【常用】

      所有的系统管理所需要的配置文件和子目录

    * /usr【常用】

      这是一个非常重要的文件，用户的很多应用层程序和文件都放在目录下，类似于windows下的programfiles目录

    * /boot【常用】

      存放的是启动Linux时使用的一些核心文件，包括一些链接文件以及镜像文件

    * /proc 【不能动】

      这个目录是一个虚拟的目录，它是系统内存的映射，访问这个目录来获取系统的信息

    * /srv【不能动】

      service缩写，该目录存放一些服务启动后需要提取的数据

    * /sys【不能动】

      这是linux2.6内核的一个很大的改变。该目录下安装了2.6内核中新出现的一个文件系统sysfs

    * /tmp

      这个目录是用来存放一些临时文件

    * /dev

      类似于windows的设备管理器，把所有的硬件用文件的形式存储

      /media【常用】linux系统会自动识别一些设备，当识别后，linux会把识别的设别挂载到这个目录下

    * /mnt【常用】

      系统提供该目录是为了让用户临时挂载个别的文件系统的，我们可以将外部的存储挂载在/mnt/上，然后进入该目录就可以查看里的内容了

    * /opt

      这是给主机额外安装软件所摆放的目录

    * /usr/local【常用】

      这是另一个给主机额外安装软件所安装的目录。一般是通过编译源码方式安装的程序

    * /var【常用】

      这个目录中存放着在不断扩充着的东西，习惯将经常被修改的目录放在这个目录下，日志文件之类的

    * /selinux【security-enhanced linux】

      SELinux是一种安全子系统，它能够控制程序只能访问特定文件，又三种工作模式，可以自行设置

# 远程开发

**Xshell**

* 说明：Xshell是目前最好的远程登录到Linux操作的软件，流畅的速度并且完美解决了中文乱码的问题

* Xshell是一个强大的安全终端模拟软件，它支持SSH1，SSH2，以及Microsoft Widows平台的TELNET协议
* Xshell可以在windows界面下用来访问远端不同系统下的服务器，从而比较好的达到了远程控制终端的目的

**Xftp**

* 是一个基于Windows平台的功能强大的SFTP、FTP文件传输软件，使用了Xftp以后，windows用户能安全地在UNIX/Linux和Windows PC之间传输文件

# vi和vim的基本介绍

Linux系统会内置vi文本编辑器

Vim具有程序编辑的功能，可以看作是vi的增强版本，可以主动的以字体颜色辨别语法的正确性，方便程序设计。代码补全、编译、错误跳转等方便变成的功能特别丰富

* 正常模式

  以vim打开一个档案就直接进行一般模式了（这是默认的模式）。在这个模式，你可以使用【上下左右】按键来移动光标，你可以使用【删除字符】或【删除整行】来处理档案内容，也可以使用【复制、粘贴】来处理你的文件数据

* 插入模式

  按下i，I，o，O，a，A，r，R等任何一个字母之后才会进入编辑模式，一般来说按i即可

* 命令行模式

  在这个模式当中，可以提供你相关指令，完成读取、存盘、替换、离开vim、显示行号等的动作则是再次模式中达成

**常用操作**——摆烂

# 开机、关机

* 基本操作

  | 命令操作        | 简介                 |
    | --------------- | -------------------- |
  | shutdown -h now | 立即进行关机         |
  | shutdown -h 1   | 1分钟之后关机        |
  | shutdown -r now | 重启计算机           |
  | halt            | 关机                 |
  | reboot          | 重启                 |
  | sync            | 把内存数据同步到磁盘 |

# 用户登录与注销

* 基本介绍
    1. 登录时尽量少使用root账号登录，因为它是系统管理员，最大的权限，避免操作事务。可以利用普通用户登录，登录后在使用`su 用户名`命令来切换程系统管理员身份
    2. 在提示符下输入logout即可注销用户
* 使用细节
    1. logout注销指令在图形运行级别无效，在运行级别3下有效

# 用户管理

Linux系统是一个多用户多任务的操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统

* 添加用户

    * 基本语法

      `useradd 用户名`

    * 细节说明

      当创建用户成功后，会自动创建和用户名同名的家目录

      也可以通过`useradd -d`指定目录 指定目录 新的用户名

* 指定修改密码

    * 基本语法

      `passwd 用户名`

* 删除用户

    * 基本语法

      `userdel 用户名`

    * 细节说明

      直接使用`userdel 用户名`保存了家目录

      使用`userdel -r 用户名`删除家目录【慎用】

      一般情况下建议保留

* 查询用户信息

    * 基本语法

      `id 用户名`

    * 使用细节

      当用户不存在时，返回无此用户

      `id: temp: no such user`

* 切换用户

    * 介绍

      在操作Linux中，如果当前用户权限不够，可以通过`su`指令，切换到高权限用户

    * 基本语法

      `su 切换用户名`

    * 细节说明

      从高权限用户切换到低权限用户不需要输入密码

      当返回原来的用户时，使用exit/logout指令

* 查看当前用户信息

    * 基本语法

      `whoami/who am i`

# 用户组

* 介绍

  类似于角色，系统可以对有共性的多个角色进行统一管理

* 新增组

  指令：`groupadd 组名`

* 删除组

  指令：`groupdel 组名`

* 增加用户时直接加上组

  指令：`useradd -g 用户组 用户名`

* 修改用户的组

  指令：`usermod -g 用户组 用户名`

# 用户与组相关文件

* /etc/passwd

  用户（user）的配置文件，记录用户的各种信息

  **每行的含义：用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录shell**

* /etc/shadow

  口令的配置文件

  **每行的含义：登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志**

* /etc/group

  组的配置文件，记录组的信息

  **每行的含义：组名:口令:组标识号:组内用户列表**

# 运行级别

运行级别说明——

0：关机

1：单用户【找回丢失密码】

2：多用户状态没有网络服务

3：多用户状态有网络服务

4：系统未使用保留给用户

5：图形界面

6：系统重启

常用的运行级别时3和5，也可以指定默认运行级别

`init 级别` 来切换运行级别

**设置默认级别**

* CentOS7之前在/etc/inittab文件中设置

* CentOS7以后进行简化

  `multi-user.target: analogous to runlevel3`

  `graphical.target: analogous to runlevel5`

  显示当前级别

  `systemctl get-default`

  设置默认运行级别

  `systemctl set-default TARGET.target`

# 找回root密码

1. 重启时，输入e进入编辑界面
2. 进入编辑界面，使用键盘上下将光标向下移动，找到以”Linux16“开头的内容所在行数，在行的最后面输入：`init=/bin/sh`
3. 按快捷键`Ctrl+x`进入单用户模式’
4. 输入`mount -o remount,rw /`完成后按下回车
5. 在新的一行输入`passwd`,再按下回车，输入密码，然后再次确认密码即可
6. 输入`touch / .autorelabel `

7. 输入`exec /sbin/init`

# 帮助指令

* man 获取帮助信息

  基本语法：`man [命令或配置文件] (功能描述：获取帮助信息)`

* help指令

  基本语法：`help 命令 (功能描述：获取shell内置命令的帮助信息)`

# 文件目录指令

* pwd指令

  基本语法：`pwd`

  功能描述：显示当前工作目录的绝对路径

* ls指令

  基本语法：`ls [选项] [目录或是文件]`

  常用选项：

   -a：显示当前目录所有的文件和目录，包括隐藏的

   -l：以列表的方式显示信息

* cd指令

  基本用法：`cd [参数]`

  功能描述：切换到指定目录

  `cd ~ | cd`：回到自己的家目录

  `cd ..`：回到当前目录的上一级目录

* mkdir指令

  基本语法：`mkdir [选项] 要创建的目录`

  功能描述：创建目录

  常用选项：

   -p：创建多级目录

* rmdir指令

  基本语法：`rmdir [选项] 要删除的空目录`

  功能描述：删除空目录

  使用细节：

  rmdir删除的时空目录，如果目录下有内容时将无法删除的

  如果需要删除非空目录，需要使用`rm -rf 要删除的目录`

* touch指令

  基本语法：`touch 文件名称`

  功能描述：创建空文件

* cp指令

  基本语法：`cp [选项] source dest`

  功能描述：拷贝文件到指定目录

  常用选项：

   -r：递归复制整个文件夹

  使用细节：

  强制覆盖不提示使用`\cp` ex:`\cp -r /home/bbb /opt`

* rm指令

  基本语法：`rm [选项] 要删除的文件或目录`

  功能描述：移除文件或目录

  常用选项：

   -r：递归删除整个文件夹

   -f：强制删除不提示

* mv指令

    * 基本语法：`mv oldNameFile newNameFile`

      功能描述：重命名

    * 基本语法：`mv /temp/movefile /targetFolder`

      功能描述：移动文件

* cat指令

  基本语法：`cat [选项] 要查看的文件`

  功能描述：查看文件内容

  常用选项：

  -n：显示行号

  使用细节：

  cat只能浏览文件，而不能修改文件，为了浏览方便，一般会带上管道命令 | more

* more指令

  基本语法：`more 要查看的文件`

  功能描述：

  more指令是一个基于vi编译器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。more指令中内置了若干快捷键

  操作说明：

  | 操作   | 功能说明                           |
    | ------ | ---------------------------------- |
  | 空白键 | 代表向下翻一页                     |
  | Enter  | 代表向下翻一行                     |
  | q      | 代表立刻离开more，不再显示文本内容 |
  | Ctrl+F | 向下滚动一屏                       |
  | Ctrl+B | 返回上一屏                         |
  | =      | 输出当前行的行号                   |
  | :f     | 输出文件名和当前的行号             |

* less指令

  基本语法：`less 要查看的文件`

  功能描述：

  less指令用来分屏查看文件内容，他的功能和more指令类似，但是比more指令更加强大，支持各种显示终端，less指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有较高效率

  操作说明：

  | 操作       | 功能说明                      |
    | ---------- | ----------------------------- |
  | 空白键     | 向下翻动一页                  |
  | [pagedown] | 向下翻动一页                  |
  | [pageup]   | 向上翻动一页                  |
  | /字串      | 向下搜寻[字串]的功能；类似vim |
  | ?字串      | 向上搜寻[字串]的功能；类似vim |
  | q          | 离开less程序                  |

* echo指令

  基本语法：`echo [选项] [输出内容]`

  功能描述：输出内容到控制台

* head指令

  基本语法：

  `head 文件` （查看文件头10行内容）

  `head -n 5 文件` （查看文件头5行内容）

  功能描述：希纳是文件的开头部分内容，默认情况下head指令显示文件头10行内容

* tail指令

  基本语法：

    * `tail 文件`（查看文件尾10行内容）
    * `tail -n 5 文件`（查看文件尾5行内容）
    * `tail -f 文件`（实时追踪文档的所有更新）

* \>指令和\>\>指令

  基本语法：

    * `ls -l > 文件`（列表的内容写入指定文件中（覆盖））
    * `ls -al >> 文件`（列表的内容追加到指定文件的末尾）
    * `cat 文件1 > 文件2`（将文件1的内容覆盖到文件2）
    * `echo "内容" >> 文件`

* ln指令

  基本语法：`ln -s [原文件或目录] [软连接名]`（给原文件创建一个软连接）

  功能描述：

  软连接也成为符号链接，类似windows里的快捷方式，主要存放了链接其他文件的路径

  细节说明：当我们使用pwd指令查看目录时，然然看到的是软链接所在目录

* history指令

  基本语法：`history`

  功能描述：查看已经执行过的历史命令

  使用细节：

  执行历史编号为5的指令——`!5`

# 时间日期指令

* date指令——显示当前日期

  基本语法：

    * `date`（显示当前时间）
    * `date + %Y`（显示当前年份）
    * `date + %m`（显示当前月份）
    * `date + %d`（显示当前是那一天）
    * `date “+%Y-%m-%d %H:%M%S"`（显示年月日时分秒）

* date指令——设置日期

  基本语法：`date -s 字符串时间`

* cal指令

  基本语法：`cal [选项]`（不加选项，显示本月日历）

  功能描述：查看日历指令

# 查找命令

* find指令

  基本语法：`find [搜索范围] [选项]`

  功能描述：find指令将从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端

  选项说明：

  | 选项            | 功能                             |
    | --------------- | -------------------------------- |
  | -name<查询方式> | 按照指定的文件名查找模式查找文件 |
  | -user<用户名>   | 查找属于指定用户所有的文件       |
  | -size<文件大小> | 按照指定的文件大小查找文件       |

  使用细节：

  使用-size选项+200代表大于200 -200代表小于200 单位K，M，G

* locate指令

  基本语法：`locate 搜索文件`

  功能描述：

  locate指令可以快速定位文件路径。locate指令利用事先建立的系统中所有文件名称及路径的locate数据库实现快速定位给定的文件。locate指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确性，管理员必须定期更行locate

  特别说明：

  **由于locate指令基于数据库进行查询，所以第一次运行前，必须使用updatedb指令创建locate数据库**

* which指令

  基本语法：`witch 指令名称`

  功能描述：可以查看某个指令在那个目录下

* grep指令和管道符号 |

  基本语法：`grep [选项] 查找内容 源文件`

  功能描述：

  grep过滤查找，管道符”|“，表示将前一个命令的处理结果输出传递给后面的命令处理

  常用选项：

  | 选项 | 功能             |
    | ---- | ---------------- |
  | -n   | 显示匹配行及行号 |
  | -i   | 忽略字母带小写   |

# 压缩和解压

* gzip / gunzip指令

  基本语法：

    * `gzip 文件`（压缩文件，只能姜文加压缩为\*.gz文件）
    * `gunzip 文件.gz`（解压缩文件命令）

  功能描述：gzip用于压缩文件，gunzip用于解压文件

  -v：打印执行过程

  -d：解压.gz文件

  -f：递归

  -k：保留原文件

* zip / unzip指令

  基本语法：

    * `zip [选项] xxx.zip 将要压缩的内容`（压缩文件和目录的命令）
    * `unzip [选项] xxx.zip`（解压缩文件）

  常用选项：

  -r：递归压缩，压缩目录（zip）

  -d<目录>：指定解压后文件的存放位置

* tar指令

  基本语法：

  **`tar [选项] xxx.tar.gz 打包的内容`**（打包目录，压缩后的文件格式.tar.gz）

  功能描述：打包指令，最后打包后的文件是tar.gz的文件

  选项说明：

  | 选项 | 功能             |
    | ---- | ---------------- |
  | -c   | 产生.tar打包文件 |
  | -v   | 显示详细信息     |
  | -f   | 指定压缩后文件名 |
  | -z   | 打包同时压缩     |
  | -x   | 解包.tar文件     |

# 组管理和权限管理

在Linux中的每个用户必须属于一个组，不能独立于组外。在Linux中每个文件有所有者、所在组、其他组的概念

* 文件/目录 所有者

  一般为文件的创建者，谁创建了该文件，就自然的称为该文件的所有者

    * 查看文件的所有者

      指令：`ls -ahl`

    * 修改文件所有者

      指令：`chown 用户名 文件名`

* 文件/目录 所在组

    * 添加组

      基本指令：`groupadd 组名`

    * 查看文件/目录所在组

      基本指令：`ls -ahl`

    * 修改文件所在的组

      基本指令：`chgrp 组名 文件名`

* 其他组

  除文件的所有者和所在组的用户外，系统的其他用户都是文件的其他组

* 改变用户所在组

    * `usermod -g 组名 用户名`
    * `usermod -d 目录名 用户名` **改变该用户登录的初始目录**
        * 特别说明：用户需要有进入到新目录的权限

* 权限基本介绍

  `ls -l`

  `-rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc`

  0-9为说明——

    * 第0位确定文件类型(d, -, l, c, b)
        * l是链接，相当于windows的快捷方式
        * d是目录，相当于windows的文件夹
        * c是字符设备文件，鼠标，键盘之类
        * b是块设备，比如硬盘
    * 第1-3位确定所有者（该文件的所有者）拥有该文件的权限 ---User
    * 第4-6位确定所属组（同用户组的）拥有该文件的权限 ---Group
    * 第7-9位确定其他用户拥有该文件的权限 ---Other

  其他说明：

    * 1 文件：硬链接数 目录：子目录数
    * root 用户
    * root 组
    * 1213 文件大小（字节）
    * Feb 2 09:39 最后修改日期
    * abc 文件名

* rwx权限解释

    * rwx作用到文件
        1. [r]代表可读（read）：可以读取，查看
        2. [w]代表可写（write）：可以修改，但是不代表可以删除该文件，删除一个文件的前提是对该文件的目录有写的权限，才能删除该文件 3. [x]代表可执行（execute）：可以被执行
    * rwx作用到目录
        1. [r]代表可读（read）：可以读取，ls查看目录内容
        2. [w]代表可写（write）：可以修改，对目录内创建+删除+重命名目录 3. [x]代表可执行（execute）：可以进入该目录

  r=4 w=2 x=1

* 修改权限——chmod

  基本说明：通过chmod命令，可以修改文件或者目录的权限

    * 第一种方式：+、-、=变更权限

      u：所有者 g：所在组 o：其他人 a：所有人

* 修改文件所有者——chown

  基本介绍：

  `chown newowner 文件/目录 改变所有者`

  `chown newowner:newgroup 文件/目录 改变所有者和所在组`

  -R 如果是目录，则使用其下所有子文件或目录递归生效

* 修改文件所在组——chgrp

  基本介绍：

  `chgrp newgroup 文件/目录 改变所在组`

# crond任务调度

crontab进行定时任务的设置

任务调度：是指系统在某个时间执行的特定命令和程序

任务调度分类：

* 系统工作：有些重要的工作必须周而复始地执行
* 个别用户工作：个别用户可能希望执行某些程序

基本语法：

`crontab [选项]`

常用选项：

| 选项 | 功能                          |
| ---- | ----------------------------- |
| -e   | 编辑crontab定时任务           |
| -l   | 查询crontab任务               |
| -r   | 删除当前用户所有的crontab任务 |

**快速入门**

1. 设置任务调度文件——`/etc/crontab`
2. 设置个人任务调度——执行`crontab -e`
3. 输入任务到调度文件

参数说明：

| 项目     | 含义                   | 范围                    |
| -------- | ---------------------- | ----------------------- |
| 第一个\* | 一个小时当中的第几分钟 | 0-59                    |
| 第二个\* | 一天中的第几个小时     | 0-23                    |
| 第三个\* | 一个月中的第几天       | 1-31                    |
| 第四个\* | 一年当中的第几个月     | 1-12                    |
| 第五个\* | 一周中的星期几         | 0-7（0和7都代表星期天） |

特殊符号说明：

| 特殊符号 | 含义                 |
| -------- | -------------------- |
| \*       | 代表任意时间         |
| ，       | 代表不连续的时间     |
| -        | 代表连续的时间范围   |
| \*/n     | 代表间隔多久执行一次 |

# at定时任务

* 基本介绍

    1. at命令是一次性定时计划任务，at的守护进程atd会一后台模式运行，检查作业队列来运行
    2. 默认情况下，atd守护进程每60秒检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，则运行此作业
    3. at命令是一次性定时计划任务，执行完一个任务不在星星此任务
    4. 在使用at命令时，一个定要保证atd进程的启动，可以使用相关指令来查看

* at命令格式

  `at [选项] [时间]    `

  Ctrl + D 结束at命令的输入

* at命令选项

  | 选项         | 含义                                     |
    | ------------ | ---------------------------------------- |
  | -m           | 当前指定的任务被完成后，将给用户发送邮件 |
  | -I           | atq的别名                                |
  | -d           | atrm的别名                               |
  | -v           | 显示任务将被执行的时间                   |
  | -c           | 打印任务的内容到标准输出                 |
  | -V           | 显示版本信息                             |
  | -q<队列>     | 使用指定队列                             |
  | -f<文件>     | 从指定文件读入任务而不是标准输入读入     |
  | -t<时间参数> | 以时间参数的形式提交要运行的任务         |

* at时间定义

    1. 接受在当天的hh：mm的时间指定。假如时间已过去，那么久放在第二天执行
    2. 使用midnight、noon、teatime等比较模糊的词语来指定时间
    3. 采用12小时计时制，及在时间后面加上AM（上午）或PM（下午）来说明上午还是下午
    4. 采用命令执行的具体日期，指定格式位month day或mm/dd/yy或dd.mm.yy，指定的日期必须跟在指定时间的后面
    5. 使用相对计时法。指定格式为：now + count
       time-units，now就是当前时间，time-units是时间单位，这里能够使minutes（分钟）、hours（小时）、days（天）、weeks（星期）。count是时间日期
    6. 直接使用today、tomorrow来指定完成时间

**atp命令用来查看系统中没有执行的工作任务**

**atrm指令用来删除已经设置的任务** `atrm 编号`

# 磁盘分区机制

* 原理介绍
    1. Linux来说无论有几个分区，分给那一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构，Linux中每个分区都是用来组成整个文件系统的一部分
    2. Linux采用一种叫载入的处理方法，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录联系起来。这是要载入的一个分区将使它的存储空间在一个目录下获得

* 查看所有设备挂载情况

  `lsblk`或者`lsble -f`

# 增加磁盘应用案例

https://www.bilibili.com/video/BV1Sv411r7vd?p=59

1.

在【虚拟机】菜单中，选择【设置】，然后设备列表里添加硬盘，然后一路【下一步】，中间只有选择磁盘大小的地方需要修改，直到完成。**然后重启系统**

2.

分区命令 fdisk /dev/sdb

开始对/sdb分区

m 显示命令列表

p 显示磁盘分区（同：fdisk -l）

n 新增分区

d 删除分区

w 写入并退出

说明：开始分区后输入n，新增分区，然后选择p，分区类型为主分区。两次回车默认剩余全部空间。最后输入w写入分区并退出，若不保存退出输入q

3.

格式化磁盘

分区命令：mkfs -t ext4 /dev/sdb1

其中ext4是分区类型

4.

挂载：将一个分区与一个目录联系起来

`mount 设备名称 挂载目录`

`unmount 设备名称或挂载目录`

**使用命令行挂载，重启后失效**

5.

永久挂载：通过修改/etc/fstab实现挂载

添加完成后 执行mount -a 即可生效

# 磁盘情况查询

* 查询系统整体磁盘使用情况

  `df -h`

  查询系统整体磁盘使用情况

* 查询指定目录的磁盘占用情况

  `du -h /目录`

  查询指定目录的磁盘占用情况，默认为当前目录

  -s 指定目录占用大小汇总

  -h 带计量单位

  -a 含文件

  --max-depth=1 子目录深度

  -c 理出明细的同时，增加汇总值

# 虚拟机网络配置

`vim /etc/sysconfig/network-script/ifcfg-ens33`

修改网络配置文件

```
TYPE="Ethernet"
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="static"
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="ens33"
UUID="884c8ff0-a64d-448c-a54e-65cf9ead21a7"
DEVICE="ens33"
ONBOOT="yes"
IPADDR=192.168.187.130
GATEWAY=192.168.187.2
DNS1=192.168.187.2
```

`service network restart`

重启网络服务

# 主机名和host映射

`/etc/host`

# 进程管理

ps详解

* 指令：`ps -aux | grep xxx`

* 指令说明
    * System V 展示风格
    * USER 用户名称
    * PID 进程号
    * %CPU 进程占用CPU的百分比
    * %MEM 进程占用物理内存的百分比
    * VSZ 进程占用虚拟内存的大小
    * RSS 进程占用物理内存的大小
    * TTY 终端名称，缩写
    * STAT 进程状态，其中S-睡眠，s-表示该进程是会话的先导进程，N-表示进程拥有比普通优先级更低的优先级，R-正在运行，D-短期等待，Z-僵死进程，T-被跟踪或者被停止等等
    * STAETED：进程的启动时间
    * TIME：CPU时间，即进程使用CPU的总时间
    * COMMAND：启动进程所用的命令和参数，如果过长会被截断显示

* 指令：`ps -ef | grep xxx`

* 指令说明
    * -e显示所有进程
    * -f全格式
    * UID 用户id
    * PID 进程id
    * ppid 父进程id
    * c cup用于计算执行优先级的因子。数值越大，表明进程是cup密集型运算，执行优先级会降低。数值越小，表明进程是I/O密集型运算，执行优先级会提高
    * STIME 进程启动时间
    * TTY 完整的终端名称
    * TIME CUP时间
    * CMD 启动进程所用的命令和参数

* 指令：`kill [选项] 进程号`（功能描述：通过进程号杀死/终止进程）

* 指令：`killall 进程名称`（功能描述：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用）

    * 常用选项

      -9：表示强制进程立即停止

* 指令：`pstree [选项]`

    * 常用选项

      -p：显示进程的PID

      -u：显示进程的所属用户

# 服务管理

* 介绍

  服务（Service）本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其他程序的请求，比如（mysql、sshd、防火墙等），因此我们又称为守护进程，是Linux中非常重要的知识点

* service管理指令

    1. `service 服务名 [start | stop | restart | reload | status]`

    2. 在CentOS7.0后很多服务不在使用service，而是使用systemctl

    3. service指令管理的服务在/etc/init.d中查看

       ![image-20220508085403787](..\Picture\Linux\service指令管理的服务.png)

* 服务的运行级别（runlevel）

  Linux系统有7中运行级别：常用的是级别3和5

  运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动

  运行级别1：单用户工作状态，root权限，用于系统维护，禁止远程登陆

  运行级别2：多用户状态（没有NFS），不支持网络

  运行级别3：完全的多用户状态（有NFS），登陆后进入控制台命令行模式

  运行级别4：系统未使用，保留

  运行级别5：X11控制台，登录后进入图形GUI模式

  运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动

![image-20220508090825472](..\Picture\Linux\开机流程)

* chkconfig指令

    * 介绍

        1. 通过chkconfig命令可以给服务的各个运行级别设置自启动/关闭
        2. chkconfig指令管理的服务在/etc/init.d查看
        3. **CentOS7.0**后，很多服务使用systemctl管理

    * chkconfig基本语法

        * `chkconfig --list [|grep xxx]`
        * `chkconfig 服务名 --list`
        * `chkconfig --level 5 服务名 on/off`

    * 使用细节

      **chkconfig重新设置服务后自启动或关闭，需要重启机器reboot**

* systemctl管理指令

    1. 基本语法：`systemctl [start | stop | restart | status] 服务名`
    2. systemctl指令管理的服务在/usr/lib/systemd/system查看

* systemctl设置服务的自启动状态

    1. `systemctl list-unit-files [|grep 服务名]`（查看服务开机启动状态，grep可以进行过滤）
    2. `systemctl enable 服务名`（设置服务开机启动）
    3. `systemctl disable 服务名`（关闭服务开机启动）
    4. `systemctl is-enable 服务名`（查询某个服务是否是自启动的）

* 使用细节

    1. 关闭或者启动防火墙后，立即生效
    2. 这种方式只是临时生效，当重启系统后，还是回归以前对服务器的设置
    3. 如果希望设置某个服务自启动或者关闭永久生效，要使用2-3命令

* 打开或者关闭指定端口

* firewall指令

  打开端口：`firewall-cmd --permanent --add-port=端口号/协议`

  关闭端口：`firewall-cmd --permanent --remove-port=端口号/协议`

  重新加载，才能生效：`firewall-cmd --reload`

  查询端口是否开放：`firewall-cmd --query-port=端口/协议`

# 动态监控进程

* 介绍

  top和ps命令相似，他们都是用来显示正在执行的进程。top和ps最大的不同之处，在于top在执行一段时间可以更新正在运行的进程

* 基本语法

  `top [选项]`

* 选项说明

  | 选项    | 功能                                       |
    | ------- | ------------------------------------------ |
  | -d 秒数 | 指定top命令每隔几秒更新，默认3秒           |
  | -i      | 使用top不显示任何闲置或者僵死的进程        |
  | -p      | 通过指定监控进程ID来仅仅监控某个进程的状态 |

* 交互操作说明

  | 操作 | 功能                          |
    | ---- | ----------------------------- |
  | p    | 以cpu使用率排序，默认就是此项 |
  | M    | 以内存的使用排序              |
  | N    | 以PID排序                     |
  | q    | 退出top                       |

# 监控网络状态

* 查看系统网络情况netstat

  基本语法——`netstat [选项]`

  选项说明——

  -an 按一定顺序排序输出

  -p 显示哪个进程在调用

* 检测主机连接命令ping：

  是一种网络检测检测工具，它主要是用检测远程主机是否正常，或者两部主机间的网线或者网卡故障

# 软件包管理

* rpm包的简单查询指令

  `rpm -qa|grep xx`

* rem包名基本格式

  一个rpm包名：firefox-60.2.2-1.el7.centos.x86_64

  名称：firefox

  版本号：60.2.2-1

  适用操作系统：el7.centos.x86_64

  表示centos7.x的64位系统

  如果是i686、i386表示32位系统，noarch表示通用

* rpm包的其他查询指令

  `rpm -qa`：查询所安装的所有rpm软件包

  `rpm -qa | more`

  `rpm -qa | grep x`

  `rpm -q 软件报名`：查询软件包是否安装

  `rpm -qi 软件包名`：查询软件包信息

  `rpm -ql 软件包名`：查询软件包中的文件

  `rpm -qf 文件全路径名`：查询文件所属的软件包

* 卸载rpm包

  `rpm -e RPM包的名称`

* yum使用

  `yum list | grep xxx`：查看是否有需要安装的软件

  `yum install xxx`：安装软件